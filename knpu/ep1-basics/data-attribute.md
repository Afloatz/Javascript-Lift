# Data Attribute

Time to finally hook up the AJAX and actually delete one of these rows. I already took care of the server side for us. If you want to look at it, it's inside of the source app under controller directory, repLogController. I have a number of different restful API endpoints and one of them is called, deleteRepLogAction. We pass a /reps/the ID of the rep and then it deletes it from the database and returns a blank response. Pretty simple. As long as we hit this endpoint with the right ID with a delete method we'll be fine.

In index.html.twig, inside of a listener, how can we get the URL to this particular row? For example, what is the ID of this particular repLog? Well, we don't really know. We know that this link is being clicked, but this link doesn't give us any information about which repLog is being clicked or what it's URL to the delete endpoint is. This is a really common thing. When you want to attach extra meta data to your DOM, so that in JavaScript, you can read it and take action. There actually a proper way to attach extra information to your DOM, and it's via the data attribute. It's not something invented. The rule actually says you are allowed to add data attributes that start with data- and then lowercase letters afterwards. In this case, we'll set one to data-URL equals and I'll use the symphony way of linking, which is to say repLog delete the name of that endpoint and then pass it ID and then repLog.ID. We now have the URL to that endpoint on the anchor tag itself.

Now down below to fetch it, we can simply say var delete URL equals this, which we now know is the link, the anchor, .dataURL. That's a little bit of JQuery magic. It allows you to read any of your data attributes by using this nice data function. Awesome. Then the AJAX call is really simple. I'll use $.AJAX, set URL to delete URL, method to delete, and we'll set up a success function down here. Now with the success function what we probably want to have happen is that entire row should probably disappear.

To find the row, I'll say var $row equals this, again the link, .closest TR. So the closest function starts with your link and actually goes up until it finds an element matching that, so that will find our TR element. Notice again I'm using $row, because this is going to be a Jquery object. Inside the success, we'll say row.fadeout for a little bit of fancy.

Cool, try that out. Refresh, delete my coffee cup and life is good. If I refresh, everything is still gone. The only problem is, you'll notice if I delete my coffee cup here, the total weight doesn't change on the bottom. It doesn't change until we actually refresh the page and that's kind of lame. I'll re add my coffee cup and let's fix that.

There are a few different ways to do this. If we ... Somehow knew what the weight was for this specific row then we could read the total weight and just subtract the weight that's being deleted right now. It'd be a very easy JavaScript way of doing it, but when we're inside of this function here, we don't really know what the weight is of our particular row. Sure, we could, I guess read the HTML of the third column, but that's not a good solution because what if the weight becomes the fourth column? There's a better way to do it. Again, it goes back to that data attribute.

A better way is to go up to our row and add a data-weight. So hey, anybody needs to read the weight for this particular row, we'll just print it right here with repLog.TotalWeightLifted. Also, so we know which TH down here to update, I'll add a JS class js-total-weight. Now we can read this number and we can read this number for the one that was deleted. We can subtract them. Damn it ...

Let's do it. Before the AJAX call and this is actually important and we'll talk about why later. Let's find the total weight container. The TH that contains the total weight. We'll say table.find js-total-weight. Next we can say var.NewWeight. We know this is going to be totalweight.container.html, kind of a lazy way to get the current number of the total weight minus row.data and we can read the new data-weight attribute.

Finally, inside success here, we can say totalweightcontainer.html equals the new weight. Let's give this fanciness a try. Go back refresh. 459? Hit delete, it's gone. 454, we got it.
